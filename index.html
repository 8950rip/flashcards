<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>FlashCards – Учись с удовольствием</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: #f0f4f2;
      color: #14532d;
      min-height:100vh;
      display:flex; flex-direction:column;
    }
    .container {
      max-width: 1100px;
      margin: auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.1);
      overflow: hidden;
      display: flex; flex-direction: column; flex:1;
    }
    header {
      background: linear-gradient(90deg,#047857,#34d399);
      color:#fff;
      padding: 1rem;
      text-align: center;
    }
    header .logo { font-size:2rem; margin-bottom:0.2rem; }
    header h1 { font-size:1.5rem; }

    .app-container { display:flex; flex:1; }
    .sidebar {
      width: 240px;
      background: #ecfdf5;
      border-right:1px solid #d1fae5;
      display:flex;flex-direction:column;
      padding:1rem;
    }
    .sidebar h3 {
      color:#047857; margin-bottom:0.5rem;
    }
    .category-list { list-style:none; margin-bottom:1rem; }
    .category-item {
      padding:0.6rem 1rem;
      border-radius:6px;
      cursor:pointer;
      display:flex;justify-content:space-between;
      transition: background 0.2s;
    }
    .category-item.active,
    .category-item:hover {
      background:#d1fae5;
    }
    .btn {
      margin-top:auto;
      padding:0.75rem;
      background:#34d399;
      color:#fff;
      border:none; border-radius:6px;
      font-weight:600;
      cursor:pointer;
      display:flex; align-items:center; justify-content:center; gap:0.5rem;
      transition:transform .2s;
    }
    .btn:hover { transform:translateY(-2px); }

    .main-content { flex:1; padding:1rem; display:flex; flex-direction:column; }

    .mode-selector {
      display:flex; gap:0.5rem; margin-bottom:1rem;
    }
    .mode-btn {
      flex:1; padding:0.6rem; border:none; border-radius:6px;
      background:#d1fae5; color:#047857; font-weight:600; cursor:pointer;
      transition:background .2s;
    }
    .mode-btn.active { background:#047857; color:#fff; }

    .card-container {
      flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center;
      perspective:1000px; margin-bottom:1rem;
    }
    .flashcard {
      width:100%; max-width:500px; height:300px;
      position:relative; transform-style:preserve-3d;
      transition:transform .6s; cursor:pointer;
    }
    .flashcard.flipped { transform:rotateY(180deg); }
    .card-front, .card-back {
      position:absolute; width:100%; height:100%;
      backface-visibility:hidden;
      border-radius:12px; padding:1rem;
      display:flex; flex-direction:column; justify-content:center; align-items:center;
      box-shadow:0 8px 24px rgba(0,0,0,0.1);
      text-align:center;
    }
    .card-front { background:#ddfdf3; color:#047857; }
    .card-back {
      background:#047857; color:#fff;
      transform:rotateY(180deg);
    }
    .card-title { font-size:1.2rem; margin-bottom:0.5rem; font-weight:600; }
    .card-content { font-size:1.5rem; font-weight:500; }

    .navigation {
      display:flex; align-items:center; justify-content:space-between;
      width:100%; max-width:500px;
    }
    .nav-btn {
      background:#34d399; border:none; border-radius:50%;
      width:48px; height:48px; color:#fff; font-size:1.2rem;
      display:flex; align-items:center; justify-content:center;
      cursor:pointer; transition:transform .2s;
    }
    .nav-btn:hover { transform:scale(1.1); }

    .card-counter { font-weight:600; color:#047857; }

    #scoreboard { text-align:center; font-size:1rem; color:#14532d; margin-top:0.5rem; }

    @media(max-width:800px) {
      .app-container { flex-direction:column; }
      .sidebar { width:100%; border-right:none; border-bottom:1px solid #d1fae5; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo"><i class="fas fa-layer-group"></i></div>
      <h1>FlashCards – Учись с удовольствием</h1>
    </header>
    <div class="app-container">
      <aside class="sidebar">
        <h3>Мои наборы</h3>
        <ul class="category-list">
          <li class="category-item active"><span>Основные понятия</span><span>99</span></li>
        </ul>
        <button class="btn" id="start-quiz">
          <i class="fas fa-play"></i> Начать квиз
        </button>
      </aside>
      <main class="main-content">
        <div class="mode-selector">
          <button class="mode-btn active" data-mode="learn">Обучение</button>
          <button class="mode-btn" data-mode="quiz">Тест</button>
        </div>
        <div class="card-container">
          <div class="flashcard" id="card">
            <div class="card-front">
              <div class="card-title">Нажмите «Начать квиз»</div>
            </div>
            <div class="card-back">
              <div class="card-title"></div>
            </div>
          </div>
        </div>
        <div class="navigation">
          <button class="nav-btn" id="prev" disabled><i class="fas fa-arrow-left"></i></button>
          <div class="card-counter">– / –</div>
          <button class="nav-btn" id="next" disabled><i class="fas fa-arrow-right"></i></button>
        </div>
        <div id="scoreboard"></div>
      </main>
    </div>
  </div>

  <script>
    let cards = [], mode='learn', index=0, score=0, total=0, quizList=[];
    const cardEl = document.getElementById('card');
    const front = cardEl.querySelector('.card-front');
    const back = cardEl.querySelector('.card-back');
    const prevBtn = document.getElementById('prev');
    const nextBtn = document.getElementById('next');
    const counter = document.querySelector('.card-counter');
    const scoreboard = document.getElementById('scoreboard');
    const startQuiz = document.getElementById('start-quiz');
    const modeBtns = document.querySelectorAll('.mode-btn');

    // Загрузка карточек из Markdown
    fetch('flashcards.md')
      .then(r=>r.text())
      .then(text=>{
        const lines = text.split(/\\r?\\n/);
        let q=null,a='';
        lines.forEach(l=>{
          const m=l.match(/^\\d+\\.\\s\\*\\*(.+?)\\*\\*/);
          if(m){
            if(q) cards.push({q,a:a.trim()});
            q=m[1]; a='';
          } else if(q && l.trim()) {
            a+=l.trim()+'\\n';
          }
        });
        if(q) cards.push({q,a:a.trim()});
        total=cards.length;
        updateCard();
      });

    // Переключение режимов
    modeBtns.forEach(b=>{
      b.onclick=()=>{
        modeBtns.forEach(x=>x.classList.remove('active'));
        b.classList.add('active');
        mode = b.dataset.mode;
        reset();
      }
    });

    // Запуск квиза
    startQuiz.onclick = ()=>{
      mode='quiz';
      modeBtns.forEach(x=>{
        if(x.dataset.mode==='quiz') x.classList.add('active');
        else x.classList.remove('active');
      });
      let n = parseInt(prompt('Сколько вопросов?',10));
      if(isNaN(n)||n<1) return;
      total = Math.min(n,cards.length);
      quizList = shuffle(cards).slice(0,total);
      score=0; index=0;
      updateCard();
    };

    // Отобразить карточку
    function updateCard(){
      const data = mode==='quiz'? quizList[index] : cards[index];
      front.innerHTML=`<div class="card-title">${data.q}</div>`;
      back.innerHTML=`<div class="card-title">${data.a.replace(/\\n/g,'<br>')}</div>`;
      cardEl.classList.remove('flipped');
      prevBtn.disabled = index===0;
      nextBtn.disabled = (mode==='learn' ? index===cards.length-1 : index===total-1);
      counter.textContent = `${index+1} / ${mode==='learn'?cards.length:total}`;
      scoreboard.textContent = mode==='quiz'?`Правильно: ${score}/${total}`:'';
    }

    // Управление навигацией и ответами
    cardEl.onclick = ()=> cardEl.classList.toggle('flipped');
    prevBtn.onclick = ()=>{ if(index>0){ index--; updateCard(); } };
    nextBtn.onclick = ()=>{
      if(mode==='quiz' && !cardEl.classList.contains('flipped')){
        alert('Сначала переверните карточку и нажмите ОК, чтобы засчитать ответ.');
        cardEl.classList.add('flipped');
      } else {
        if(mode==='quiz'){
          score++;
        }
        if(index< (mode==='learn'?cards.length-1:total-1)) index++;
        else if(mode==='quiz'){
          alert(`Квиз окончен. Результат: ${score}/${total}`);
          reset();
          return;
        }
        updateCard();
      }
    };

    function reset(){
      index=0; score=0; total=cards.length; quizList=[];
      updateCard();
    }

    function shuffle(a){
      for(let i=a.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [a[i],a[j]]=[a[j],a[i]];
      }
      return a;
    }
  </script>
</body>
</html>
